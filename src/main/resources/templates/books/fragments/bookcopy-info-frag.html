<div th:fragment="copyList(book)">
    <h3>Book Copies</h3>

    <!-- Show global messages -->
    <div class="error" th:if="${error}" th:text="${error}"></div>
    <div class="success" th:if="${success}" th:text="${success}"></div>

    <table class="bluetable">
        <thead>
        <tr>
            <th>Simple ID</th>
            <th>Available</th>
            <th>Location</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="copy : ${book.bookCopies}">
            <!-- Simple ID -->
            <td>
                <form th:action="@{'/books/copy/save/' + ${copy.id}}" method="post">
                    <input type="text" name="simpleId" th:value="${copy.simpleId}" required />
            </td>

            <!-- Availability Icon -->
            <td th:text="${copy.available ? '✔' : '❌'}"></td>

            <!-- Location -->
            <td>
                <input type="text" name="location" th:value="${copy.location}" />
            </td>

            <!-- Actions (Save + Delete) -->
            <td>
                <button type="submit" class="btn-primary">Save</button>
                </form>

                <form th:action="@{'/books/copy/delete/' + ${copy.id}}" method="post" style="display:inline;">
                    <input type="hidden" name="confirmFallback" value="true" />
                    <button type="submit" class="delete-icon-button" title="Delete"
                            onclick="return confirm('This copy has checkout history. Mark it as unavailable instead?');">&#128465;</button>
                </form>

            </td>
        </tr>

        </tbody>
    </table>
</div>
