<div th:fragment="checkouts (checkouts, showDays, showStudentName)">
    <h3>Current Checkouts</h3>
    <table class="bluetable">
        <thead>
        <tr>
            <th th:if="${showStudentName}">Student</th>
            <th>Title</th>
            <th>Copy</th>
            <th>Checked Out</th>
            <th>Due Date</th>
            <th th:if="${showDays}">Days Until Due</th>
            <th>Status</th>
            <th>Action</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="checkout : ${checkouts}">
            <td th:if="${showStudentName}" th:text="${checkout.user.name}">Student</td>
            <td th:text="${checkout.bookCopy.book.title}">Title</td>
            <td th:text="${checkout.bookCopy.simpleId}">Copy</td>
            <td th:text="${checkout.checkoutDate}">Checked</td>
            <td th:text="${checkout.dueDate}">Due</td>

            <td th:if="${showDays}"
                th:text="${T(java.time.temporal.ChronoUnit).DAYS.between(T(java.time.LocalDate).now(), checkout.dueDate)}">
                0
            </td>

            <td>
                <span th:if="${checkout.returnDate != null}">Returned</span>
                <span th:if="${checkout.returnDate == null}">
                    <span th:classappend="${checkout.dueDate.isBefore(T(java.time.LocalDate).now())} ? 'text-warning'">
                        Out
                    </span>
                </span>
            </td>

            <td>
                <form method="post" th:action="@{/checkouts/return-by-id}">
                    <input type="hidden" name="checkoutId" th:value="${checkout.id}"/>
                    <button type="submit"
                            class="button"
                            th:disabled="${checkout.returnDate != null}">
                        Return
                    </button>
                </form>
            </td>
        </tr>
        </tbody>
    </table>
</div>
